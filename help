Building:
1. docker buildx build --build-arg BUILDKIT_INLINE_CACHE=1 --progress=plain .
2. aws ecr get-login-password --region us-east-2 | docker login --username AWS --password-stdin 473860850071.dkr.ecr.us-east-2.amazonaws.com
3. docker tag b2f9c9f46b3340e06f5458f6074cb17beead89196cfe4e9f26ba79daf217eaec 473860850071.dkr.ecr.us-east-2.amazonaws.com/activepieces
4. docker push 473860850071.dkr.ecr.us-east-2.amazonaws.com/activepieces
5. Add service to the congress

"activepieces": {
  "deployment": {
    "image": "473860850071.dkr.ecr.us-east-2.amazonaws.com/activepieces:latest",
    "port": 80,
    "environments": {
      "AP_API_KEY": "secret",
      "AP_DB_TYPE": "POSTGRES",
      "AP_EDITION": "ce",
      "AP_LICENSE_KEY": "1234567890",
      "AP_ENVIRONMENT": "prod",
      "AP_ENCRYPTION_KEY": "7e19fad4c13eaea8f657afb12e8f9c40",
      "AP_EXECUTION_MODE": "SANDBOXED",
      "AP_JWT_SECRET": "super-secret",
      "AP_POSTGRES_DATABASE": "activepieces",
      "AP_POSTGRES_HOST": "scrimmage-db.{{ .Release.Namespace }}.svc.cluster.local",
      "AP_POSTGRES_PORT": "5432",
      "AP_QUEUE_MODE": "MEMORY",
      "AP_SIGN_UP_ENABLED": "true",
      "AP_FRONTEND_URL": "https://{{ .Release.Namespace }}.apps.scrimmage.co/_workflows/",
      "AP_WEBHOOK_URL": "https://{{ .Release.Namespace }}.apps.scrimmage.co/_workflows/",
      "AP_POSTGRES_USERNAME": "zbmyveax",
      "AP_POSTGRES_PASSWORD": "BAMMXj+hW4l12fq5S3334ainGurX",
      "SCRIMMAGE_PARTNER_ID": "nanachi",
      "WEB3_SERVICE_AUTH_TOKEN": "",
      "NBC_SERVICE_AUTH_TOKEN": "",
    },
    "resources": {
      "requests": {
        "cpu": "500m",
        "memory": "800Mi"
      },
      "limits": {
        "cpu": "800m",
        "memory": "800Mi"
      }
    }
  },
  "scaling": {
    "minReplicas": 1,
    "maxReplicas": 10,
    "cpuUtilization": 70,
    "memoryUtilization": 80
  },
  "ingress": {
    "baseDomain": "apps.scrimmage.co",
    "path": "/_workflows/(.*)"
  }
}

Setup:
1. Create new user in DB

INSERT INTO "user" ("id", "created", "updated", "email", "firstName", "lastName", "password", "status", "trackEvents", "newsLetter", "imageUrl", "title", "externalId") VALUES
('WwbA3xIZlm7B42m4qrnNC', '2023-11-02 10:38:14', '2023-11-02 10:38:14', 'dev@ap.com', 'firstName', 'lastName', '$2b$10$uWW5m56gVjLzLWvak6VMoOjb8iqIId5NZ6oQnAiwwwljAU9/d.FCK', 'VERIFIED', '0', '0', NULL, NULL, NULL);

2. Create new project in DB

INSERT INTO "project" ("id", "created", "updated", "ownerId", "displayName", "notifyStatus", "type", "platformId", "externalId") VALUES
('WwbA3xIZlm7B42m4qrnNC', '2023-11-02 10:38:14', '2023-11-02 10:38:14', 'WwbA3xIZlm7B42m4qrnNC', 'firstName''s Project', 'ALWAYS', 'STANDALONE', NULL, NULL);


3. Create default folders

insert into public.folder (id, created, updated, displayName, projectId)
values  ('quests', '2023-11-09 12:57:23.951328 +00:00', '2023-11-09 12:57:23.951328 +00:00', 'Quest Flows', 'WwbA3xIZlm7B42m4qrnNC'),
        ('notifications', '2023-11-09 12:57:58.005098 +00:00', '2023-11-09 12:57:58.005098 +00:00', 'Notification Flows', 'WwbA3xIZlm7B42m4qrnNC'),
        ('other', '2023-11-09 12:57:58.005098 +00:00', '2023-11-09 12:57:58.005098 +00:00', 'Other Flows', 'WwbA3xIZlm7B42m4qrnNC');

Locally <base href="/" />, in production <base href="/_workflows/" />


userData=
{"id":"WwbA3xIZlm7B42m4qrnNC","created":"2023-11-02T10:38:14.000Z","updated":"2023-11-02T10:38:14.000Z","email":"dev@ap.com","firstName":"firstName","lastName":"lastName","status":"VERIFIED","trackEvents":false,"newsLetter":false,"imageUrl":null,"title":null,"externalId":null,"token":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjEifQ.eyJpZCI6Ild3YkEzeElabG03QjQybTRxcm5OQyIsInR5cGUiOiJVU0VSIiwicHJvamVjdElkIjoiTHhpT2FtMkNiSndaSmYxekwyVVVYIiwicHJvamVjdFR5cGUiOiJTVEFOREFMT05FIiwiaWF0IjoxNjk5MzQ5NDQ3LCJleHAiOjIzMDQxNDk0NDcsImlzcyI6ImFjdGl2ZXBpZWNlcyJ9.We41_his95wJ0de6TBXYAq8gCSYvg-Q5w4m9lC8xvAs","projectId":"LxiOam2CbJwZJf1zL2UUX"}

hideHeader=true

kubectl cp -n nanachi ./activepieces-piece-scrimmage-triggers-user-sign-up-0.0.1.tgz activepieces-799cd594b6-7mgcd:/usr/src/app/dist/packages/pieces/activepieces-piece-scrimmage-triggers-user-sign-up-0.0.1.tgz
